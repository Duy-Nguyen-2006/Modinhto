

### Pháº§n 1: Refactor (Chuáº©n hÃ³a) Code Crawlers
**Má»¥c tiÃªu:** Biáº¿n cÃ¡c file script rá»i ráº¡c hiá»‡n táº¡i thÃ nh cÃ¡c module (thÆ° viá»‡n) chuáº©n, loáº¡i bá» input/print Ä‘á»ƒ Backend cÃ³ thá»ƒ gá»i Ä‘Æ°á»£c.

**Prompt cho Coder:**
> "TÃ´i cÃ³ má»™t danh sÃ¡ch cÃ¡c file Python dÃ¹ng Ä‘á»ƒ crawl video tá»« cÃ¡c trang web khÃ¡c nhau (vÃ­ dá»¥: `heovl.py`, `javx.py`, `xhamster.py`, v.v... nhÆ° Ä‘Ã­nh kÃ¨m). Hiá»‡n táº¡i chÃºng Ä‘ang cháº¡y dáº¡ng CLI script vá»›i hÃ m `input()` vÃ  `print()`.
>
> HÃ£y giÃºp tÃ´i Refactor (viáº¿t láº¡i) toÃ n bá»™ cÃ¡c file nÃ y theo tiÃªu chuáº©n sau Ä‘á»ƒ tÃ­ch há»£p vÃ o Backend FastAPI:
> 1.  **XÃ³a bá»:** CÃ¡c hÃ m `input()`, `print()` hiá»ƒn thá»‹ káº¿t quáº£, vÃ  khá»‘i `if __name__ == "__main__":`.
> 2.  **Input:** Má»—i file chá»‰ giá»¯ láº¡i hÃ m chÃ­nh lÃ  `search_videos_by_actor(actor_name)`. HÃ m nÃ y nháº­n tham sá»‘ `actor_name` (string).
> 3.  **Output:** HÃ m pháº£i tráº£ vá» (return) má»™t List cÃ¡c Dictionary. Cáº¥u trÃºc thá»‘ng nháº¥t cho táº¥t cáº£ cÃ¡c file: `[{'source': 'TÃªn_Web', 'title': 'TiÃªu Ä‘á» video', 'link': 'Link video'}, ...]`.
> 4.  **Xá»­ lÃ½ lá»—i:** Sá»­ dá»¥ng try/except. Náº¿u trang web lá»—i hoáº·c khÃ´ng tÃ¬m tháº¥y, hÃ£y tráº£ vá» danh sÃ¡ch rá»—ng `[]` chá»© khÃ´ng Ä‘Æ°á»£c raise Exception lÃ m sáº­p chÆ°Æ¡ng trÃ¬nh.
> 5.  **Crawl4AI:** Giá»¯ nguyÃªn logic `AsyncWebCrawler` nhÆ°ng Ä‘áº£m báº£o nÃ³ Ä‘Æ°á»£c gá»i Ä‘Ãºng trong mÃ´i trÆ°á»ng `async` cá»§a FastAPI.
>
> HÃ£y lÃ m máº«u trÆ°á»›c vá»›i file `heovl.py` vÃ  `javx.py`."

---

### Pháº§n 2: XÃ¢y dá»±ng Core Backend (FastAPI + Async Aggregation)
**Má»¥c tiÃªu:** Táº¡o server, gom táº¥t cáº£ crawler cháº¡y song song.

**Prompt cho Coder:**
> "Dá»±a trÃªn cÃ¡c file crawler Ä‘Ã£ chuáº©n hÃ³a á»Ÿ bÆ°á»›c trÆ°á»›c, hÃ£y viáº¿t cho tÃ´i file `main.py` sá»­ dá»¥ng thÆ° viá»‡n **FastAPI**. YÃªu cáº§u cá»¥ thá»ƒ:
>
> 1.  **Import:** Import táº¥t cáº£ cÃ¡c hÃ m search tá»« cÃ¡c file crawler (`heovl`, `javx`, `xhamster`, v.v...).
> 2.  **API Search Endpoint:** Táº¡o API `GET /api/search?q={actor_name}`.
> 3.  **Xá»­ lÃ½ song song (Quan trá»ng):** Sá»­ dá»¥ng `asyncio.gather` Ä‘á»ƒ cháº¡y táº¥t cáº£ cÃ¡c crawler cÃ¹ng má»™t lÃºc (parallel execution) Ä‘á»ƒ tá»‘i Æ°u thá»i gian. KhÃ´ng cháº¡y tuáº§n tá»±.
> 4.  **Tá»•ng há»£p káº¿t quáº£:** Gá»™p táº¥t cáº£ káº¿t quáº£ tráº£ vá» tá»« cÃ¡c crawler thÃ nh má»™t danh sÃ¡ch duy nháº¥t.
> 5.  **Timeout:** Äáº·t timeout tá»•ng lÃ  30 giÃ¢y. Náº¿u crawler nÃ o cháº¡y quÃ¡ lÃ¢u, hÃ£y bá» qua nÃ³ vÃ  tráº£ vá» káº¿t quáº£ cá»§a nhá»¯ng trang Ä‘Ã£ xong.
> 6.  **CORS:** Cáº¥u hÃ¬nh CORS Middleware Ä‘á»ƒ cho phÃ©p má»i domain truy cáº­p (Ä‘á»ƒ test Frontend sau nÃ y)."

---

### Pháº§n 3: Database & Caching (LÆ°u trá»¯ vÃ  Tá»‘i Æ°u)
**Má»¥c tiÃªu:** LÆ°u dá»¯ liá»‡u Ä‘á»ƒ lÃ m Trang chá»§ vÃ  cache káº¿t quáº£ tÃ¬m kiáº¿m.

**Prompt cho Coder:**
> "TÃ´i cáº§n bá»• sung tÃ­nh nÄƒng lÆ°u trá»¯ dá»¯ liá»‡u cho FastAPI app á»Ÿ trÃªn. HÃ£y sá»­ dá»¥ng **SQLite** (vá»›i thÆ° viá»‡n `sqlmodel` hoáº·c `sqlalchemy`) cho Ä‘Æ¡n giáº£n.
>
> 1.  **Database Models:** Táº¡o 2 báº£ng:
>     * `Actor`: id, name, avatar_url (náº¿u cÃ³), last_updated.
>     * `Video`: id, actor_id (foreign key), title, link, source, created_at.
>
> 2.  **Logic Search má»›i (Caching):**
>     * Khi gá»i API Search: Kiá»ƒm tra trong DB xem Ä‘Ã£ cÃ³ video cá»§a diá»…n viÃªn Ä‘Ã³ chÆ°a vÃ  dá»¯ liá»‡u cÃ³ má»›i khÃ´ng (vÃ­ dá»¥: crawl trong vÃ²ng 24h).
>     * Náº¿u cÃ³: Tráº£ vá» dá»¯ liá»‡u tá»« DB ngay láº­p tá»©c (khÃ´ng crawl láº¡i).
>     * Náº¿u khÃ´ng: Má»›i thá»±c hiá»‡n viá»‡c Crawl tá»« cÃ¡c nguá»“n, lÆ°u káº¿t quáº£ vÃ o DB, sau Ä‘Ã³ má»›i tráº£ vá» cho ngÆ°á»i dÃ¹ng.
>
> 3.  **API Trang chá»§:** Táº¡o API `GET /api/home`.
>     * Tráº£ vá» danh sÃ¡ch cÃ¡c diá»…n viÃªn cÃ³ trong DB.
>     * Vá»›i má»—i diá»…n viÃªn, chá»‰ láº¥y **3 video má»›i nháº¥t** Ä‘á»ƒ hiá»ƒn thá»‹ preview.
>
> 4.  **Seed Data Script:** Viáº¿t thÃªm má»™t script riÃªng `seed.py`. Script nÃ y nháº­n vÃ o má»™t danh sÃ¡ch tÃªn cÃ¡c diá»…n viÃªn ná»•i tiáº¿ng, tá»± Ä‘á»™ng cháº¡y hÃ m search Ä‘á»ƒ crawl dá»¯ liá»‡u vÃ  náº¡p vÃ o DB ban Ä‘áº§u cho trang chá»§ cÃ³ ná»™i dung."

---

### Pháº§n 4: Frontend (Giao diá»‡n ngÆ°á»i dÃ¹ng)
**Má»¥c tiÃªu:** Hiá»ƒn thá»‹ dá»¯ liá»‡u Ä‘áº¹p, cÃ³ Ã´ tÃ¬m kiáº¿m.

**Prompt cho Coder:**
> "HÃ£y viáº¿t code Frontend cho trang web nÃ y báº±ng **HTML, JavaScript (Vanilla JS), vÃ  Tailwind CSS** (dÃ¹ng link CDN, khÃ´ng cáº§n setup Node.js).
>
> 1.  **Layout:**
>     * Header: Logo bÃªn trÃ¡i, Ã” tÃ¬m kiáº¿m to vÃ  nÃºt Search á»Ÿ giá»¯a/pháº£i.
>     * Main Content: Khu vá»±c hiá»ƒn thá»‹ káº¿t quáº£.
>
> 2.  **Tráº¡ng thÃ¡i Trang chá»§ (Máº·c Ä‘á»‹nh):**
>     * Gá»i API `/api/home`.
>     * Hiá»ƒn thá»‹ danh sÃ¡ch diá»…n viÃªn dáº¡ng LÆ°á»›i (Grid).
>     * Má»—i tháº» (Card) diá»…n viÃªn gá»“m: TÃªn diá»…n viÃªn (To, Ä‘áº­m), vÃ  list 3 link video bÃªn dÆ°á»›i.
>     * Khi click vÃ o TÃªn diá»…n viÃªn hoáº·c nÃºt "Xem thÃªm": Gá»i API Search Ä‘á»ƒ láº¥y full danh sÃ¡ch.
>
> 3.  **Tráº¡ng thÃ¡i TÃ¬m kiáº¿m / Chi tiáº¿t:**
>     * Khi ngÆ°á»i dÃ¹ng search hoáº·c click xem chi tiáº¿t: Hiá»ƒn thá»‹ Loading Spinner (vÃ²ng quay) á»Ÿ giá»¯a mÃ n hÃ¬nh.
>     * Khi API tráº£ vá»: Hiá»ƒn thá»‹ danh sÃ¡ch toÃ n bá»™ video (100% link).
>     * Má»—i video item gá»“m: TiÃªu Ä‘á», Nguá»“n (Source), vÃ  NÃºt "Xem Ngay" trá» Ä‘áº¿n link gá»‘c.
>
> 4.  **UX:** Xá»­ lÃ½ trÆ°á»ng há»£p khÃ´ng tÃ¬m tháº¥y káº¿t quáº£ hoáº·c lá»—i káº¿t ná»‘i."

---

### Pháº§n 5: Deployment (Docker)
**Má»¥c tiÃªu:** ÄÃ³ng gÃ³i Ä‘á»ƒ nÃ©m lÃªn VPS.

**Prompt cho Coder:**
> "TÃ´i muá»‘n Ä‘Ã³ng gÃ³i toÃ n bá»™ á»©ng dá»¥ng nÃ y Ä‘á»ƒ cháº¡y trÃªn VPS. HÃ£y viáº¿t file `Dockerfile` vÃ  `docker-compose.yml`.
>
> LÆ°u Ã½ quan trá»ng:
> 1.  Project sá»­ dá»¥ng thÆ° viá»‡n `crawl4ai` vÃ  `playwright`, nÃªn Docker image cáº§n pháº£i cÃ i sáºµn cÃ¡c dependencies cá»§a trÃ¬nh duyá»‡t (Chromium). HÃ£y dÃ¹ng base image phÃ¹ há»£p (vÃ­ dá»¥: `mcr.microsoft.com/playwright/python:v1.xx.0-jammy`).
> 2.  `docker-compose.yml` sáº½ cháº¡y service backend (FastAPI) táº¡i port 8000.
> 3.  Viáº¿t hÆ°á»›ng dáº«n cÃ¡c lá»‡nh cáº§n thiáº¿t Ä‘á»ƒ build vÃ  cháº¡y container."

---

### ğŸ’¡ Lá»i khuyÃªn cá»§a tao cho mÃ y:
* **Thá»© tá»±:** MÃ y Ä‘Æ°a **Pháº§n 1** cho nÃ³ lÃ m trÆ°á»›c. NÃ³ gá»­i láº¡i code chuáº©n rá»“i thÃ¬ mÃ y táº¡o file lÆ°u láº¡i, rá»“i má»›i Ä‘Æ°a tiáº¿p **Pháº§n 2**. Äá»«ng Ä‘Æ°a háº¿t 1 cá»¥c nÃ³ sáº½ bá»‹ "ngÃ¡o".
* **Kiá»ƒm tra:** Sau Pháº§n 2, mÃ y cháº¡y thá»­ á»Ÿ mÃ¡y mÃ y `uvicorn main:app --reload` xem search nÃ³ cÃ³ ra káº¿t quáº£ tá»« 8 trang web khÃ´ng Ä‘Ã£. OK rá»“i háºµng lÃ m Database.
* **Database:** Ban Ä‘áº§u cá»© dÃ¹ng SQLite (nÃ³ lÆ°u thÃ nh 1 file `.db` ngay trong folder), Ä‘á»«ng ham cÃ i MySQL hay PostgreSQL vá»™i, phá»©c táº¡p khÃ¢u cÃ i Ä‘áº·t láº¯m.

Giá» mÃ y muá»‘n báº¯t Ä‘áº§u vá»›i **Pháº§n 1** luÃ´n khÃ´ng? Gá»­i file code nÃ o mÃ y muá»‘n sá»­a Ä‘áº§u tiÃªn tao lÃ m máº«u cho 1 cÃ¡i rá»“i mÃ y quÄƒng cho Codex lÃ m cÃ¡c cÃ¡i cÃ²n láº¡i y há»‡t.